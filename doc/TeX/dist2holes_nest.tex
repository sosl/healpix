\sloppy
\docid{dist2holes\_nest}\section[dist2holes\_nest]{ }
\label{sub:dist2holes_nest}
\docrv{Version 1.0}
\author{Eric Hivon}
\abstract{This document describes the \healpix Fortran90 subroutine DIST2HOLES\_NEST.}

\begin{facility}
{For a input binary mask in NESTED ordering, \thedocid\ returns the distance (in
radians) from each valid (1-valued) pixel to the closest invalid (0-valued)
pixel. Distance are measured between pixel centers}
{\modMaskTools}
\end{facility}

\begin{f90format}
{nside, mask, distance}
\end{f90format}

\begin{arguments}
{
\begin{tabular}{p{0.35\hsize} p{0.05\hsize} p{0.1\hsize} p{0.40\hsize}} \hline  
\textbf{name~\&~dimensionality} & \textbf{kind} & \textbf{in/out} & \textbf{description} \\ \hline
                   &   &   &                           \\ %%% for presentation
nside & I4B & IN & the $N_{side}$ value of the input mask. \\
mask(0:Npix-1) & I4B & IN & Input NESTED-ordered mask. Npix = 12*nside*nside\\
distance(0:Npix-1) & DP & OUT & Output NESTED-ordered angular-distance output map
\end{tabular}
}
\end{arguments}

\begin{example}
{
use healpix\_types \\
use healpix\_modules \\
% use pix\_tools, only : nside2npix \\
% use alm\_tools, only : dist2holes\_nest \\
% integer(I4B) :: nside, lmax, mmax, npix, spin\\
% real(SP), dimension(:,:), allocatable :: map \\
% complex(SPC), dimension(:,:,:), allocatable :: alm \\
% \ldots \\
% nside=256 ; lmax=512 ; mmax=lmax ; spin=4\\
% npix=nside2npix(nside)\\
% allocate(alm(1:2,0:lmax,0:mmax))\\
% allocate(map(0:npix-1,1:2))\\
\ldots \\
call dist2holes\_nest(nside, mask, distance)  \\
}
{???
}
\end{example}

\begin{modules}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
%   \item[\htmlref{ring\_synthesis}{sub:ring_synthesis}] Performs FFT over $m$ for synthesis of the rings.
%   \item[compute\_lam\_mm, get\_pixel\_layout, ]
%   \item[gen\_lamfac\_der, gen\_mfac, gen\_mfac\_spin, do\_lam\_lm\_spin, ] 
%   \item[gen\_recfac, gen\_recfac\_spin, init\_rescale, l\_min\_ylm] Ancillary routines used
%   for $Y_{\ell m}$ recursion
  \item[\textbf{misc\_utils}] module, containing:
  \item[assert\_alloc] routine to print error message, when an array can not be
  allocated properly
  \end{sulist}
\end{modules}

\begin{related}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
	\item[\htmlref{dist2holes\_nest}{sub:dist2holes_nest}] distance to
closest invalid pixel of given mask
	\item[\htmlref{fill\_holes\_nest}{sub:fill_holes_nest}] turn to valid
pixels located in 'holes' with fewer pixels than given threshold
	\item[\htmlref{maskborder\_nest}{sub:maskborder_nest}] identify inner
boundary pixels of 'holes' for given mask
	\item[\htmlref{size\_holes\_nest}{sub:size_holes_nest}] returns size (in
pixels) of holes found in input mask
  \end{sulist}
\end{related}

\rule{\hsize}{2mm}

\newpage
